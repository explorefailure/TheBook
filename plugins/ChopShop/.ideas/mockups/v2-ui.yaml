# ChopShop v2 UI Design Specification
# Generated: 2025-12-05
# Evolution: v1 static cables -> v2 TRUE modular patching system
# Aesthetic: Retro-futuristic junkyard (Junkyard Wars meets The Jetsons)

window:
  width: 650
  height: 350  # Taller to fit modular patch bay
  resizable: false

colors:
  background: "#1a1d1a"  # Dark weathered metal
  panel: "#2d3a2d"  # Patina green dark
  patina_green: "#4a6b52"  # Weathered copper patina
  patina_light: "#6b8e75"  # Light patina accent
  copper: "#b87333"  # Brass/copper hardware
  copper_dark: "#8b5a2b"  # Aged copper
  atomic_orange: "#ff6b35"  # Atomic age orange
  atomic_turquoise: "#5bc0be"  # Googie turquoise
  atomic_cream: "#fde8cd"  # Vintage cream
  rivet_shadow: "#0d0f0d"  # Deep shadow for rivets
  text: "#fde8cd"  # Cream text for readability
  cable_turquoise: "#5bc0be"  # Cable color 1
  cable_orange: "#ff6b35"  # Cable color 2
  cable_copper: "#d4a373"  # Cable color 3

typography:
  header: "'Courier New', monospace"  # Industrial stencil feel
  body: "Arial, sans-serif"
  size:
    large: "16px"
    medium: "13px"
    small: "11px"
    tiny: "9px"

layout:
  type: modular-patch-bay
  description: "Top section: modular patch bay with draggable cables. Center: hero stutter rate dial. Bottom: global controls."

# MODULAR PATCH BAY SECTION (top)
patch_bay:
  position: {x: 15, y: 50}
  size: {width: 620, height: 80}

  # Global I/O jacks
  global_jacks:
    - id: main_in
      label: "IN"
      position: {x: 30, y: 30}  # Within patch_bay coordinate space
      type: input

    - id: main_out
      label: "OUT"
      position: {x: 590, y: 30}
      type: output

  # Effect modules with mini controls
  modules:
    - id: stutter_module
      label: "STUTTER"
      position: {x: 120, y: 15}
      size: {width: 90, height: 60}
      input_jack: {x: 10, y: 30}  # Left side
      output_jack: {x: 80, y: 30}  # Right side
      mini_control:
        type: knob
        parameter: stutter_intensity
        label: "ENABLE"
        position: {x: 35, y: 18}
        size: {diameter: 24}
        range: [0.0, 1.0]
        default: 1.0

    - id: pitch_module
      label: "PITCH"
      position: {x: 230, y: 15}
      size: {width: 90, height: 60}
      input_jack: {x: 10, y: 30}
      output_jack: {x: 80, y: 30}
      mini_control:
        type: knob
        parameter: pitch_shift
        label: "ST"
        position: {x: 35, y: 18}
        size: {diameter: 24}
        range: [-24.0, 24.0]
        default: 0.0

    - id: speed_module
      label: "SPEED"
      position: {x: 340, y: 15}
      size: {width: 90, height: 60}
      input_jack: {x: 10, y: 30}
      output_jack: {x: 80, y: 30}
      mini_control:
        type: knob
        parameter: speed
        label: "%"
        position: {x: 35, y: 18}
        size: {diameter: 24}
        range: [50.0, 200.0]
        default: 100.0

    - id: reverse_module
      label: "REVERSE"
      position: {x: 450, y: 15}
      size: {width: 90, height: 60}
      input_jack: {x: 10, y: 30}
      output_jack: {x: 80, y: 30}
      mini_control:
        type: knob
        parameter: reverse_mix
        label: "MIX"
        position: {x: 35, y: 18}
        size: {diameter: 24}
        range: [0.0, 100.0]
        default: 100.0

  # Default cable connections (can be changed by user)
  default_cables:
    - id: cable_1
      from: main_in
      to: stutter_module.input
      color: cable_turquoise

    - id: cable_2
      from: stutter_module.output
      to: pitch_module.input
      color: cable_orange

    - id: cable_3
      from: pitch_module.output
      to: speed_module.input
      color: cable_turquoise

    - id: cable_4
      from: speed_module.output
      to: reverse_module.input
      color: cable_orange

    - id: cable_5
      from: reverse_module.output
      to: main_out
      color: cable_copper

# CENTER SECTION - Hero Control
controls:
  # Stutter Rate - Prominent central dial (early 1900s bakelite knob)
  - id: stutter_rate
    type: rotary-knob
    label: "STUTTER RATE"
    parameter: stutter_rate
    range: [0, 6]  # Note divisions: 1/1, 1/2, 1/4, 1/8, 1/16, 1/32, 1/64
    choices: ["1/1", "1/2", "1/4", "1/8", "1/16", "1/32", "1/64"]
    default: 3  # 1/8
    parameter_type: choice
    position: {x: 265, y: 155}
    size: {width: 120, height: 120}
    style: bakelite_hero
    label_position: bottom

# BOTTOM SECTION - Global Controls

  # LEFT SIDE - Link and Trigger

  # Link Pitch/Speed Toggle (atomic age toggle switch)
  - id: link_pitch_speed
    type: toggle
    label: "LINK P/S"
    parameter: link_pitch_speed
    default: false
    position: {x: 30, y: 285}
    size: {width: 50, height: 30}
    style: atomic_toggle
    note: "Links pitch and speed like tape behavior"

  # Trigger Mode - 3-way selector (mechanical switch)
  - id: trigger_mode
    type: combo-box
    label: "TRIGGER MODE"
    parameter: trigger_mode
    parameter_type: choice
    choices: ["Always", "MIDI", "Threshold"]
    default: 0
    position: {x: 100, y: 280}
    size: {width: 130, height: 35}
    style: mechanical_selector

  # RIGHT SIDE - Threshold and Mix

  # Threshold Knob (small bakelite knob, only active when Trigger=Threshold)
  - id: threshold
    type: rotary-knob
    label: "THRESHOLD"
    parameter: threshold
    range: [-60.0, 0.0]
    unit: "dB"
    default: -20.0
    decimals: 1
    position: {x: 460, y: 270}
    size: {width: 70, height: 70}
    style: bakelite_small
    label_position: bottom

  # Mix Knob (medium bakelite knob with copper indicator)
  - id: mix
    type: rotary-knob
    label: "MIX"
    parameter: mix
    range: [0.0, 100.0]
    unit: "%"
    default: 100.0
    decimals: 0
    position: {x: 550, y: 270}
    size: {width: 70, height: 70}
    style: bakelite_small
    label_position: bottom

special_elements:
  # Interactive modular cables (SVG with drag logic)
  - id: modular_cables
    type: cable-system
    description: "Draggable catenary curves connecting jacks"
    position: {x: 0, y: 0}
    size: {width: 650, height: 350}
    layer: cables
    interaction: drag-to-connect
    cable_style: catenary  # Natural hanging curve
    cable_thickness: 3
    cable_sag: 0.3  # 30% sag for natural droop
    cable_colors:
      - "#5bc0be"  # Turquoise
      - "#ff6b35"  # Orange
      - "#d4a373"  # Copper

  # Rivets and weathered metal texture (decorative background)
  - id: background_texture
    type: background
    layer: background
    description: "Weathered metal with exposed rivets, patina green finish"
    style: industrial_patina

  # Logo/Title (stencil lettering)
  - id: title
    type: label
    text: "CHOPSHOP"
    position: {x: 25, y: 15}
    size: {width: 200, height: 25}
    style: stencil_title
    font_size: 20

  # Atomic age decorative elements (googie curves)
  - id: googie_accent
    type: svg-overlay
    layer: decorative
    description: "Atomic age accent curves in corners"
    position: {x: 0, y: 0}
    size: {width: 650, height: 350}
    style: googie_curves

styling:
  knob_styles:
    bakelite_hero:
      diameter: 120
      body_color: "#2d3a2d"  # Dark patina green
      indicator_color: "#b87333"  # Copper
      indicator_style: brass_line
      texture: bakelite_ridges
      shadow: deep_inset
      rotation_range: [-135, 135]

    bakelite_small:
      diameter: 70
      body_color: "#2d3a2d"
      indicator_color: "#b87333"
      indicator_style: brass_line
      texture: bakelite_ridges
      shadow: deep_inset
      rotation_range: [-135, 135]

    mini_module:
      diameter: 24
      body_color: "#1a1d1a"
      indicator_color: "#5bc0be"  # Turquoise indicator
      indicator_style: dot
      texture: brushed_metal
      shadow: subtle_inset
      rotation_range: [-135, 135]

  toggle_styles:
    atomic_toggle:
      width: 50
      height: 30
      track_color: "#1a1d1a"
      active_color: "#5bc0be"  # Atomic turquoise
      inactive_color: "#4a6b52"
      handle_color: "#b87333"  # Copper
      style: retro_switch

  module_styles:
    patch_module:
      width: 90
      height: 60
      background: "#2d3a2d"
      border_color: "#b87333"  # Copper trim
      border_width: 2
      text_color: "#fde8cd"
      text_size: 9
      label_position: top_center
      corner_rivets: true
      jack_color: "#b87333"  # Brass jacks
      jack_size: 8

  selector_styles:
    mechanical_selector:
      width: 130
      height: 35
      background: "#1a1d1a"
      border_color: "#b87333"
      text_color: "#fde8cd"
      arrow_color: "#b87333"
      dropdown_style: industrial

  cable_rendering:
    type: svg-quadratic-bezier
    sag_calculation: "control_y = start_y + (horizontal_distance * sag_factor)"
    sag_factor: 0.3  # 30% droop
    stroke_width: 3
    stroke_linecap: round
    opacity: 0.85
    glow_on_hover: true
    glow_color: "#ffffff"
    glow_blur: 8
    click_tolerance: 8  # Pixels for cable click detection

notes:
  - All positions in pixels from top-left (0,0)
  - Parameter IDs use snake_case for C++ compatibility
  - Patch bay modules positioned in top section (y: 50-130)
  - Hero control centered (x: 265, y: 155)
  - Bottom controls positioned below hero (y: 270+)
  - Modular cables use catenary curve (quadratic bezier) for natural droop
  - Cable interaction: click output jack -> drag -> release on input jack
  - Cables can be deleted by clicking on them
  - Multiple cables from one output allowed (parallel splits)
  - Bakelite knobs rotate as whole unit (body + indicator together)
  - Lighting/shadows remain fixed, only texture and indicator rotate
  - Mini module knobs are smaller and simpler (24px diameter)
  - Color palette: patina greens (#2d3a2d, #4a6b52), copper (#b87333), atomic orange (#ff6b35), atomic turquoise (#5bc0be)
  - Typography: monospace stencil for headers, sans-serif for labels
  - Aesthetic goal: weathered industrial salvage with atomic age optimism + modular synth tactility
  - Minimum spacing: 15px from edges, 10px between controls (enforced)
